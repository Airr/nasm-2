     1                                  ; Name:         setcookie.asm
     2                                  ; Build:        see makefile
     3                                  ; Description:  set 4 cookies
     4                                  ;               Send cookies to web client demo
     5                                  ;               The executable of this file need to be uploaded to your webservers cgi directory
     6                                  ;               from there you can access the application from a webbrowser.
     7                                  
     8                                  bits 64
     9                                  
   326                                  [list -]
   327                                  
   328                                  section .data
   329                                  
   330                                  cookies:
   331 00000000 5365742D436F6F6B69-         db "Set-Cookie:UserID=XYZ", 10
   332 00000009 653A5573657249443D-
   333 00000012 58595A0A           
   334 00000016 5365742D436F6F6B69-         db "Set-Cookie:Password=XYZ123", 10
   335 0000001F 653A50617373776F72-
   336 00000028 643D58595A3132330A 
   337 00000031 5365742D436F6F6B69-         db "Set-Cookie:Domain=www.agguro.be", 10
   338 0000003A 653A446F6D61696E3D-
   339 00000043 7777772E6167677572-
   340 0000004C 6F2E62650A         
   341 00000051 5365742D436F6F6B69-         db "Set-Cookie:Path=/", 10
   342 0000005A 653A506174683D2F0A 
   343 00000063 436F6E74656E742D74-         db "Content-type: text/html", 10, 10
   344 0000006C 7970653A2074657874-
   345 00000075 2F68746D6C0A0A     
   346 0000007C 3C7072653E43686563-         db "<pre>Check your browser's cookies for UserID, Password, Domain and Path cookie</pre>"
   347 00000085 6B20796F7572206272-
   348 0000008E 6F7773657227732063-
   349 00000097 6F6F6B69657320666F-
   350 000000A0 72205573657249442C-
   351 000000A9 2050617373776F7264-
   352 000000B2 2C20446F6D61696E20-
   353 000000BB 616E64205061746820-
   354 000000C4 636F6F6B69653C2F70-
   355 000000CD 72653E             
   356                                  cookies.length: equ $-cookies
   357                                  
   358                                  section .text
   359                                          global _start
   360                                  _start:
   361                                  
   362 00000000 BF01000000                   mov        rdi, STDOUT
   363 00000005 48BE-                        mov        rsi, cookies
   364 00000007 [0000000000000000] 
   365 0000000F BAD0000000                   mov        rdx, cookies.length
   366 00000014 B801000000                   mov        rax, SYS_WRITE
   367 00000019 0F05                         syscall
   368 0000001B 4831FF                       xor        rdi, rdi
   369 0000001E B83C000000                   mov        rax, SYS_EXIT
   370 00000023 0F05                         syscall
