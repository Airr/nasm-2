     1                                  ; Name:        jsonobject
     2                                  ; Build:       see makefile
     3                                  ; Description: reply data in the form of a JSON object.  After building this application, you need
     4                                  ;              to upload this to your webservers cgi root folder.
     5                                  ; Remark:      For those who like to observe the network traffic, you can use:
     6                                  ;              sudo tcpdump -i lo -s0 -w capture.pcap to capture the network traffic in a file
     7                                  ;              which you can open with wireshark.
     8                                   
     9                                  bits 64
    10                                   
   327                                  [list -]
   328                                   
   329                                  section .data
   330                                   
   331                                       ; this works fine enough although other sources mention
   332                                       ; 'Content-type: text/json' and
   333                                       ; 'Content-Type: application/javascript' and
   334                                       ; 'Content-type: application/json'
   335                                  JsonObject:
   336 00000000 436F6E74656E742D74-               db   'Content-type: text/html', 0x0A, 0x0A
   337 00000009 7970653A2074657874-
   338 00000012 2F68746D6C0A0A     
   339 00000019 7B20226E616D65223A-               db   '{ "name": "agguro", "website": "http://www.agguro.be", "email": "emailaddress", "avalue": 7 }'
   340 00000022 202261676775726F22-
   341 0000002B 2C2022776562736974-
   342 00000034 65223A202268747470-
   343 0000003D 3A2F2F7777772E6167-
   344 00000046 6775726F2E6265222C-
   345 0000004F 2022656D61696C223A-
   346 00000058 2022656D61696C6164-
   347 00000061 6472657373222C2022-
   348 0000006A 6176616C7565223A20-
   349 00000073 37207D             
   350                                  .length:  equ  $-JsonObject
   351                                   
   352                                  section .text
   353                                       global _start
   354                                   
   355                                  _start:
   356                                   
   357                                       ; send the JSON object to the client
   358 00000000 BF01000000                   mov       rdi, STDOUT
   359 00000005 48BE-                        mov       rsi, JsonObject
   360 00000007 [0000000000000000] 
   361 0000000F BA76000000                   mov       rdx, JsonObject.length
   362 00000014 B801000000                   mov       rax, SYS_WRITE
   363 00000019 0F05                         syscall
   364 0000001B 4831FF                       xor       rdi, rdi
   365 0000001E B83C000000                   mov       rax, SYS_EXIT
   366 00000023 0F05                         syscall
